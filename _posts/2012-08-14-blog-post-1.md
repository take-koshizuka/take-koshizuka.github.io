---

title: ‘minimax最適性の下限を示す'
date: 2023-01-31
permalink: /posts/2023/01/blog-post-1/
tags:

- DL theory
- GNNs
- OOD

---

# Minimax最適性

以下のモデルからのi.i.dサンプル $\{(Y_i, X_i)\}_{i=1}^n$ が与えられる. 

$$
Y_i = f(X_i) + \xi_i,\ \xi_i \sim \mathcal{N}(0, \sigma^2)
$$

ただし, $f$は$\beta$階微分可能かつ, $X_i \in \mathbb{R}$

Minimax-lower bound: 

このとき, 任意のestimator $\hat{f}_n$に対して, 以下の不等式を満たす$n$に依存しない定数$c$ が存在する. 

$$
\inf_{\hat{f}_n} \sup_{f \in C^{\lceil \beta \rceil, \beta}} \mathbb{E}_f\left[ \| \hat{f} - f \|_{L^2(P_X)} \right] \geq c n^{-\frac{\beta}{2\beta + D}}
$$

推定量$\hat{f}$も$f$から生成されるデータに基づいて作られるので, $f$に依存することに注意.

$C^{k, \beta}$: 階数kの$\beta$-ヘルダー空間

[証明]

マルコフ不等式より,  任意の定数$a>0$に対して, 

$$
\mathbb{E}_f\left[ \| \hat{f} - f \|_2 \right] \geq a P_f(\| \hat{f} - f \|_2 \geq a)
$$

右辺をさらに下から抑える不等式を求めたい. 

$$
\inf_{\hat{f}_n} \sup_{f \in \mathcal{F}(\beta, L)} P_f \left(\| \hat{f}_n - f \|_2 \geq a \right) \geq \inf_{\hat{f}_n} \sup_{f \in \{ f_1, f_2,\dots, f_M \}} P_f \left(\| \hat{f}_n - f \|_2 \geq a \right)
$$

仮説空間のヘルダー空間を以下のように構成する. 

$$
\mathcal{E} = \left\{ f(x) = \sum_{k=1}^m w_k \varphi_k(x),\ w_k \in \{ 0, 1\} \right\},\ \varphi_k(x) = 2Lh_n^{\beta}K\left( \frac{x-x_k}{h_n}\right),\\
m = \lceil c_0 n^{\frac{1}{2 \beta +1}} \rceil,\ h_n = \frac{1}{m},\ x_k = \frac{k-1/2}{m}
$$

この時,  $f_j = \sum_{k=1}^m w^{(j)}_k \phi_k(x) \in  \mathcal{E}$ に対して,  Varshamov-Gilbert lemmaより, $M \geq 2^{m/8}$ かつ以下を満たすものが存在. 

$$
\sum_{i=1}^m \left( w_i^{(j)} - w_i^{(k)}\right)^2 \geq \frac{m}{8},\quad (\forall j \neq k \in \{ 1,\ \dots,\ M \})
$$

上の条件を満たすように仮説空間 $\{ f_1, \dots, f_M \}$ を構成すると, 以下が満たされる. 

構成方法は, 半径$a$の球で元の関数空間$\mathcal{E}$を埋めるイメージ. $a$が小さいほど, 近似精度が高くなる. 

$$
\| f_j - f_k \|_2 \geq 2Lh_n^{\beta + \frac{1}{2}} \|K\|_2 \sqrt{\frac{m}{8}} \geq \frac{L}{2} \|K\|_2(2c_0)^{-\beta} n^{-\frac{\beta}{2 \beta + 1}} =: 2a
$$

上の式が満たされる時, $\Psi \colon \mathcal{X} \mapsto \{0, 1, \dots, M \}$ を用いて, 以下のように書ける. 

$\Psi^* \neq j \Rightarrow \| \hat{f}_n - f_j\|^2 \geq a$ $$. だが,  $\hat{f}_n$ にもっと近い $f \in \{ f_1, \dots, f_M \}$ があるかは必ずしも言えないため, 逆は成立せず不等号になる. 

$$
\inf_{\hat{f}_n} \sup_{f \in \{ f_1, f_2,\dots, f_M \}} P_f \left(\| \hat{f}_n - f \|_2 \geq a \right) \geq \inf_{\Psi} \sup_{1 \leq j \leq M} P_{f_j}(\Psi \neq j)
$$

さらに, $I = \frac{1}{M} \sum_{m=1}^M \operatorname{KL}(f_m, f_0) \leq \alpha \log M,\ 0 < \alpha < 1$ の仮定をおく. ($c_0$の取り方で決まる.) 仮説が数$M$が多くなるほど, 見分けるのが難しくなるが, 有限であるという仮定. 

Fano’s lemmaより, 以下が成立する. 

$$
P_{f_j}(\Psi \neq j) \geq 1 - \frac{I + \log 2}{\log M} \geq 1 - \alpha - \frac{\log 2}{\log M} =: b
$$

最終的に以下のlower-boundが求まる. 

$$
\inf_{\hat{f}_n} \sup_{f \in \mathcal{F}(\beta, L)} \mathbb{E}_f\left[ \| \hat{f} - f \|_{L^2(P_X)} \right] \geq \tilde{a}b n^{-\frac{\beta}{2 \beta + 1}},\ \tilde{a} = \frac{L}{2} \|K\|_2(2c_0)^{-\beta}
$$


