---

title: Hölder関数クラスのノンパラメトリック推定におけるminimax下界
date: 2023-01-31
permalink: /posts/2023/01/blog-post-1/
tags:

- Generalization
- Nonparametric

---

# Hölder関数クラスのノンパラメトリック推定におけるminimax下界

## 問題設定

以下のモデルからのi.i.dサンプル $\{(X_i, Y_i)\}_{i=1}^n$ が与えられる. 

$$
Y_i = f(X_i) + \xi_i,\ \xi_i \sim \mathcal{N}(0, \sigma^2)
$$

ただし, $f: \mathbb{R}^d \mapsto \mathbb{R}$ は $\beta$ 階微分可能かつ, $X_i \in \mathbb{R}^D$ はD次元の入力であり, 決定的である.

定理を示すために確認すべきことは, $\xi$ のルベーグ測度に対するガウス確率密度 $p_{\xi}$ に対して, 以下を満たす $p_*,\ v_0$ が存在する.

$$
\forall |v| \leq v_0,\ \int p_{\xi}(u) \log \frac{p_{\xi}(u)}{p_{\xi}(u+v)} \mathrm{~d}u \leq p_*v^2
$$

## 定理

任意のestimator $\hat{f}_n$ に対して, 以下の不等式を満たす $n$ に依存しない定数 $c$ が存在する. 

$$
\inf_{\hat{f}_n} \sup_{f \in C^{\lfloor \beta \rfloor, \beta}} \mathbb{E}_f\left[ \| \hat{f} - f \|_{L^2(P_X)} \right] \geq c n^{-\frac{\beta}{2\beta + D}}
$$

ただし, $C^{k, \beta}$ は階数 $k$ の $\beta$ -Hölder空間である. 推定量 $\hat{f}$ も $f$ から生成されるデータに基づいて作られるので, $f$ に依存することに注意. 

本定理は, Hölderクラスに入っている真の関数の, 有限サンプルによる近似レートの限界オーダーを示している. 逆に, これと同じレートで近似可能な手法があれば, 理論上最適な手法と言える. (ミニマックス最適)

## 証明

マルコフ不等式より,  任意の定数 $a>0$ に対して, 

$$
\mathbb{E}_f\left[ \| \hat{f} - f \|_2 \right] \geq a P_f(\| \hat{f} - f \|_2 \geq a)
$$

右辺をさらに下から抑える不等式を求めたい. 

$$
\inf_{\hat{f}_n} \sup_{f \in C^{\lfloor \beta \rfloor, \beta}} P_f \left(\| \hat{f}_n - f \|_2 \geq a \right) \geq \inf_{\hat{f}_n} \sup_{f \in \{ f_1, f_2,\dots, f_M \}} P_f \left(\| \hat{f}_n - f \|_2 \geq a \right)
$$

仮説空間のHölder空間 $C^{\lfloor \beta \rfloor, \beta}$ を以下のように構成する. 

$$
\mathcal{E} = \left\{ f(x) = \sum_{k=1}^m w_k \varphi_k(x),\ w_k \in \{ 0, 1\} \right\} \subseteq C^{\lfloor \beta \rfloor, \beta},\ \varphi_k(x) = 2Lh_n^{\beta}K\left( \frac{x-x_k}{h_n}\right), \\
m = \lceil c_0 n^{\frac{1}{2 \beta +D}} \rceil,\ h_n = \frac{1}{m},\ x_k = \frac{k-1/2}{m}
$$

この時,  $f_j = \sum_{k=1}^m w^{(j)}_k \phi_k(x) \in  \mathcal{E}$ に対して,  Varshamov-Gilbert lemmaより, $M \geq 2^{m/8}$ かつ以下を満たすものが存在. 

$$
\sum_{i=1}^m \left( w_i^{(j)} - w_i^{(k)}\right)^2 \geq \frac{m}{8},\quad (\forall j \neq k \in \{ 1,\ \dots,\ M \})
$$

上の条件を満たすように仮説空間 $\{ f_1, \dots, f_M \}$ を構成すると, 以下が満たされる. 

$$
\| f_j - f_k \|_2 \geq 2Lh_n^{\beta + \frac{1}{2}} \|K\|_2 \sqrt{\frac{m}{8}} \geq \frac{L}{2} \|K\|_2(2c_0)^{-\beta} n^{-\frac{\beta}{2 \beta + D}} =: 2a
$$

半径aのM個の球で関数空間$\mathcal{E}$を埋めているイメージ. データ数nが大きくなるにしたがって, Mを大きく取り, 一方でaは小さく取る必要がある. このトレードオフの良いバランスが存在すると言っており, aは小さくなるので近似精度は高まる. $\| f_j - f_k \|_2 \geq 2a$ の時, $\Psi \colon \mathcal{X} \mapsto \{0, 1, \dots, M \}$ を用いて, 式(5)の右辺は以下のように書ける. 

$$
\inf_{\hat{f}_n} \sup_{f \in \{ f_1, f_2,\dots, f_M \}} P_f \left(\| \hat{f}_n - f \|_2 \geq a \right) \geq \inf_{\Psi} \sup_{1 \leq j \leq M} P_{f_j}(\Psi \neq j)
$$

$\inf$ は真の関数からの距離が近いものを探す問題から, 真の $f_j$ を当てる問題になっている.　不等号になるのは, $\Psi^* \neq j \Rightarrow \| \hat{f}_n - f_j\|^2 \geq a$ だが, 逆は成立しないため. $\| \hat{f}_n - f_j\|^2 \geq a$ でも必ずしも $\hat{f}_n$ にもっと近い $f_k$ があるかは不明である.

Fano’s lemmaより, 以下が成立する. 

$$
P_{f_j}(\Psi \neq j) \geq 1 - \frac{I + \log 2}{\log M} \geq 1 - \alpha - \frac{\log 2}{\log M} =: b
$$

2つ目の不等号は, $c_0$ をうまく取ることで, $0 < \alpha < 1$ に対して, $I=\frac{1}{M} \sum_{m=1}^M \operatorname{KL}(f_m, f_0) \leq \alpha \log M$ となることを使った. ([1] p.106参照.) 

最終的に以下のlower boundが求まる. 

$$
\inf_{\hat{f}_n} \sup_{f \in C^{\lfloor \beta \rfloor, \beta}} \mathbb{E}_f\left[ \| \hat{f} - f \|_{L^2(P_X)} \right] \geq \tilde{a}b n^{-\frac{\beta}{2 \beta + D}},\ \tilde{a} = \frac{L}{2} \|K\|_2(2c_0)^{-\beta}
$$

## 備考

上の証明は, Fano’s lemmaを用いた証明で, 他にもいくつか証明方法がある. [1]の2.7章参照

[1] Sampson, Paul D., and Peter Guttorp. "Nonparametric estimation of nonstationary spatial covariance structure." *Journal of the American Statistical Association* 87.417 (1992): 108-119.

